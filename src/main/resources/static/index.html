<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>Parking Management</title>
    <style>
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: linear-gradient(to right, #d7e1ec, #f5f5f5);
      padding: 40px;
      animation: fadeIn 1s ease-in;
    }
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(20px); }
      to { opacity: 1; transform: translateY(0); }
    }
    h1 { color: #2c3e50; }
    input, button {
      padding: 10px;
      margin: 5px 0;
      font-size: 16px;
      width: 100%;
      box-sizing: border-box;
    }
    button {
      background-color: #3498db;
      color: white;
      border: none;
      margin-top: 10px;
      cursor: pointer;
      border-radius: 5px;
      transition: background-color 0.3s ease;
    }
    button:hover {
      background-color: #2980b9;
    }
    .card {
      background: white;
      padding: 20px;
      margin-top: 20px;
      border-radius: 10px;
      box-shadow: 0 4px 8px rgba(0,0,0,0.1);
      max-width: 600px;
      animation: fadeIn 0.8s ease;
    }
    .section {
      margin-bottom: 40px;
    }
    ul {
      list-style: none;
      padding: 0;
    }
    li {
      background: #ecf0f1;
      padding: 10px;
      margin-bottom: 5px;
      border-radius: 6px;
      transition: transform 0.3s ease;
    }
    li:hover {
      transform: scale(1.02);
    }
    #result {
  position: sticky;
  top: 40px;
  align-self: flex-start;
  background: white;
  padding: 20px;
  margin-top: 0;
  border-radius: 10px;
  box-shadow: 0 4px 8px rgba(0,0,0,0.1);
  max-width: 600px;
  height: fit-content;
}

    </style>
</head>
<body>
<div style="display: flex; gap: 40px;">
    <div style="flex: 1;">
        <h1>주차장 관리 시스템</h1>

        <div class="section">
            <h2>1. 주차장 전체 목록 조회</h2>
            <button onclick="getAllData()">전체 조회</button>
            <ul id="parkingList" class="card"></ul>
            <ul id="availabilityList" class="card"></ul>
        </div>

        <div class="section">
            <h2>2. 주차장 개별 조회 (GET)</h2>
            <input type="number" id="getId" placeholder="주차장 ID 입력">
            <button onclick="getParking()">조회</button>
        </div>

        <div class="section">
            <h2>3. 주차장 추가 (POST)</h2>
            <input type="text" id="postName" placeholder="주차장 이름">
            <input type="text" id="postLocation" placeholder="위치">
            <input type="number" id="postTotalSpots" placeholder="총 자리 수">
            <button onclick="createParking()">추가</button>
        </div>

        <div class="section">
            <h2>4. 주차장 빈자리 업데이트 (PUT)</h2>
            <input type="number" id="putId" placeholder="주차장 ID 입력">
            <input type="number" id="putEmptySpots" placeholder="새 빈자리 수 입력">
            <button onclick="updateParking()">업데이트</button>
        </div>

        <div class="section">
            <h2>5. 주차장 빈자리 삭제 (DELETE)</h2>
            <input type="number" id="deleteId" placeholder="주차장 ID 입력">
            <button onclick="deleteParking()">삭제</button>
        </div>
    </div>

    <div style="flex: 1;">
        <div id="result" class="card" style="display: none;">
            <h3>결과</h3>
            <pre id="resultContent"></pre>
        </div>
    </div>
</div>

<script>
const BASE_URL = 'https://port-0-backend-m9z3p2p78bad92ca.sel4.cloudtype.app';

async function getParking() {
  const id = document.getElementById('getId').value;
  const res = await fetch(`${BASE_URL}/api/parking/availability/${id}`);
  const data = await res.json();
  showResult(data);
}

async function getAllData() {
  const parkingRes = await fetch(`${BASE_URL}/api/parking`);
  const parkingList = await parkingRes.json();
  const availabilityRes = await fetch(`${BASE_URL}/api/parking/availability`);
  const availabilityList = await availabilityRes.json();

  const pList = document.getElementById('parkingList');
  const aList = document.getElementById('availabilityList');
  pList.innerHTML = '<li><b>[주차장 목록]</b></li>';
  aList.innerHTML = '<li><b>[빈자리 목록]</b></li>';

  parkingList.forEach(p => {
    const item = document.createElement('li');
    item.textContent = `ID: ${p.id} / 이름: ${p.name} / 위치: ${p.location} / 총자리: ${p.totalSpots}`;
    pList.appendChild(item);
  });

  availabilityList.forEach(a => {
    const item = document.createElement('li');
    item.textContent = `주차장 ID: ${a.parkingId} / 빈자리: ${a.emptySpots} / 갱신: ${a.updatedAt}`;
    aList.appendChild(item);
  });
}

async function createParking() {
  const name = document.getElementById('postName').value;
  const location = document.getElementById('postLocation').value;
  const totalSpots = document.getElementById('postTotalSpots').value;

  const res = await fetch(`${BASE_URL}/api/parking`, {
    method: 'POST',
    headers: { 'Content-Type': 'application/json' },
    body: JSON.stringify({ name, location, totalSpots: Number(totalSpots) })
  });
  const data = await res.json();
  showResult(data);
}

async function updateParking() {
  const id = document.getElementById('putId').value;
  const emptySpots = document.getElementById('putEmptySpots').value;

  const res = await fetch(`${BASE_URL}/api/parking/availability/${id}`, {
    method: 'PUT',
    headers: { 'Content-Type': 'application/json' },
    body: JSON.stringify({ parkingId: Number(id), emptySpots: Number(emptySpots) })
  });
  const data = await res.json();
  showResult(data);
}

async function deleteParking() {
  const id = document.getElementById('deleteId').value;
  const res = await fetch(`${BASE_URL}/api/parking/${id}`, {
    method: 'DELETE'
  });
  if (res.ok) {
    showResult({ message: `주차장 ID ${id} 삭제 완료.` });
  } else {
    const data = await res.json();
    showResult(data);
  }
}

function showResult(data) {
  const resultCard = document.getElementById('result');
  const resultContent = document.getElementById('resultContent');
  resultCard.style.display = 'block';
  resultContent.textContent = JSON.stringify(data, null, 2);
}
</script>
</body>
</html>

