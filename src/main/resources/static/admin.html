<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>ì–´ë“œë¯¼ ì£¼ì°¨ì¥ ê´€ë¦¬</title>
    <style>
    body {
      font-family: 'Segoe UI', Tahoma, sans-serif;
      background: #f0f4f8;
      padding: 30px;
    }
    h1 {
      color: #2c3e50;
    }
    .container {
      display: flex;
      flex-direction: row;
      gap: 40px;
    }
    .panel, .result-panel {
      background: white;
      padding: 20px;
      border-radius: 10px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
      width: 100%;
    }
    input, button, select {
      width: 100%;
      padding: 10px;
      margin-top: 10px;
      font-size: 15px;
      box-sizing: border-box;
    }
    button {
      background-color: #3498db;
      color: white;
      border: none;
      border-radius: 5px;
      cursor: pointer;
    }
    button:hover {
      background-color: #2980b9;
    }
    pre {
      background: #ecf0f1;
      padding: 10px;
      border-radius: 6px;
      overflow: auto;
    }
  </style>
</head>
<body>
<h1>ParkingGo - ì–´ë“œë¯¼ ì£¼ì°¨ì¥ ê´€ë¦¬</h1>
<div class="container">
    <div class="panel">
        <h2>ğŸ“Œ ì£¼ì°¨ì¥ ë°ì´í„° ê´€ë¦¬</h2>
        <button onclick="getAll()">ì „ì²´ ëª©ë¡ ì¡°íšŒ</button>

        <h3>ì£¼ì°¨ì¥ ì¶”ê°€</h3>
        <input type="text" id="addName" placeholder="ì£¼ì°¨ì¥ ì´ë¦„">
        <input type="text" id="addLocation" placeholder="ìœ„ì¹˜">
        <input type="number" id="addTotal" placeholder="ì´ ìë¦¬ ìˆ˜">
        <input type="number" id="addEmpty" placeholder="ë¹ˆìë¦¬ ìˆ˜">
        <input type="text" id="addParkingName" placeholder="í‘œì‹œìš© ì´ë¦„ (ì˜µì…˜)">
        <button onclick="createParking()">ì¶”ê°€</button>

        <h3>ì£¼ì°¨ì¥ ìˆ˜ì •</h3>
        <input type="number" id="updateId" placeholder="ìˆ˜ì •í•  ì£¼ì°¨ì¥ ID">
        <input type="number" id="updateEmpty" placeholder="ìƒˆ ë¹ˆìë¦¬ ìˆ˜">
        <button onclick="updateAvailability()">ë¹ˆìë¦¬ ìˆ˜ì •</button>

        <h3>ì£¼ì°¨ì¥ ì‚­ì œ</h3>
        <input type="number" id="deleteId" placeholder="ì‚­ì œí•  ì£¼ì°¨ì¥ ID">
        <button onclick="deleteParking()">ì‚­ì œ</button>
    </div>

    <div class="result-panel">
        <h2>ğŸ“‹ ê²°ê³¼</h2>
        <pre id="result">ë°ì´í„°ê°€ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤</pre>
    </div>
</div>

<script>
const BASE = 'https://port-0-backend-m9z3p2p78bad92ca.sel4.cloudtype.app';

async function getAll() {
  const res1 = await fetch(`${BASE}/api/parking`);
  const res2 = await fetch(`${BASE}/api/parking/availability`);
  const data1 = await res1.json();
  const data2 = await res2.json();
  show({ parking: data1, availability: data2 });
}

async function createParking() {
  const body = {
    name: document.getElementById('addName').value,
    location: document.getElementById('addLocation').value,
    totalSpots: Number(document.getElementById('addTotal').value),
    emptySpots: Number(document.getElementById('addEmpty').value),
    parkingName: document.getElementById('addParkingName').value
  };
  const res = await fetch(`${BASE}/api/parking/full`, {
    method: 'POST',
    headers: { 'Content-Type': 'application/json' },
    body: JSON.stringify(body)
  });
  show(await res.json());
}

async function updateAvailability() {
  const id = document.getElementById('updateId').value;
  const empty = document.getElementById('updateEmpty').value;
  const res = await fetch(`${BASE}/api/parking/availability/${id}`, {
    method: 'PUT',
    headers: { 'Content-Type': 'application/json' },
    body: JSON.stringify({ parkingId: Number(id), emptySpots: Number(empty) })
  });
  show(await res.json());
}

async function deleteParking() {
  const id = document.getElementById('deleteId').value;
  const res = await fetch(`${BASE}/api/parking/${id}`, { method: 'DELETE' });
  if (res.ok) show({ message: `ì£¼ì°¨ì¥ ID ${id} ì‚­ì œ ì™„ë£Œ` });
  else show(await res.json());
}

function show(data) {
  document.getElementById('result').textContent = JSON.stringify(data, null, 2);
}
</script>
</body>
</html>
